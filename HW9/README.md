# General Linear ODE Solver (Numerical Approach)

這是一個使用 Python `numpy` 庫求解**常係數齊次線性常微分方程 (Homogeneous Linear ODE with Constant Coefficients)** 的通用求解器。

本程式採用**數值分析 (Numerical Analysis)** 的方法，直接將計算出的特徵根轉換為通解字串。為了展示計算機數值運算的真實特性與限制，本程式**不進行**人為的誤差修飾、代數簡化或共軛項合併。

## 1. 數學原理

### 1.1 微分方程形式
本程式求解的方程形式為 $n$ 階線性齊次微分方程：

$$
a_n y^{(n)} + a_{n-1} y^{(n-1)} + \dots + a_1 y' + a_0 y = 0
$$

其中 $a_i$ 為常數係數。

### 1.2 特徵方程式 (Characteristic Equation)
根據微分方程理論，我們假設解的形式為 $y = e^{rx}$。代入原方程可得特徵多項式：

$$
P(r) = a_n r^n + a_{n-1} r^{n-1} + \dots + a_1 r + a_0 = 0
$$

程式的核心在於求解此多項式的根 $r$（特徵根）。

## 2. 演算法邏輯與基底函數

程式使用 `numpy.roots` 數值求解多項式的根，並根據根的性質構造通解。通解是所有線性獨立解的線性組合：

$$
y(x) = \sum C_k \cdot \text{Basis}_k(x)
$$

程式依據以下規則生成基底函數：

### 情況 A：實數根 (Real Roots)
若特徵根 $r$ 為實數（且虛部完全為 0）：
* **基本項**：$e^{rx}$
* **重根處理**：若 $r$ 出現 $m$ 次，則生成 $m$ 個項：
  $$e^{rx}, \quad x e^{rx}, \quad \dots, \quad x^{m-1} e^{rx}$$

### 情況 B：複數根 (Complex Roots)
若特徵根為 $r = \alpha + i\beta$（虛部不為 0）：
* **基本項**：程式分別生成 $e^{\alpha x} \cos(\beta x)$ 與 $e^{\alpha x} \sin(\beta x)$。
* **注意**：本程式採用數值直譯法。若方程式有共軛複數根 $r_1 = \alpha + i\beta$ 和 $r_2 = \alpha - i\beta$，程式會視為兩個獨立的根，分別生成對應的 sin/cos 項。這會導致常數係數數量倍增（例如二階方程出現 4 個常數 $C_1 \dots C_4$），這是未經代數簡化的原始結果。

## 3. 數值誤差與輸出特性說明

由於本程式直接輸出 `numpy` 的運算結果，輸出字串會忠實呈現 IEEE 754 浮點數運算的特性。使用者應預期看到以下現象：

### 3.1 浮點數精度 (Floating Point Precision)
電腦無法精確儲存某些小數或無理數。
* **現象**：整數 2 可能被計算為 `2.0000000000000004` 或 `1.99999999`。
* **結果**：輸出字串中會包含長串的小數，而非整潔的整數。

### 3.2 負零現象 (Negative Zero)
在浮點數標準中，`0.0` 與 `-0.0` 是不同的位元表示。
* **現象**：若根的實部運算結果為 `-0.0`。
* **結果**：輸出會顯示 `e^(-0.0x)`。

### 3.3 幽靈複數 (Ghost Complex Roots)
對於理論上的高階實數重根（例如 $(r-2)^3=0$），數值演算法求解伴隨矩陣特徵值時，可能會產生極小的虛部誤差（例如 $10^{-12}i$）。
* **現象**：程式檢測到 `imag != 0`。
* **結果**：原本應該是 $e^{2x}$ 的項，會被判定為複數，進而輸出含有 `cos` 和 `sin` 的項（且內部頻率極小）。

## 4. 使用範例

```python
import ode1  # 假設你的檔名為 ode1.py

# 範例：求解 y'' - 3y' + 2y = 0
# 係數對應：y'' (1), y' (-3), y (2)
coeffs = [1, -3, 2]

solution = ode1.solve_ode_general(coeffs)
print(solution)

# 預期輸出 (包含浮點數格式):
# y(x) = C_1e^(2.0x) + C_2e^(1.0x)
